{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "70ea0ff0",
   "metadata": {},
   "source": [
    "### Run the DOM Merge-by-Player Pipeline (2000â€“2024)\n",
    "\n",
    "This cell loads and executes the `dom_merge_by_player` pipeline, which rebuilds\n",
    "full DOM / RDOM / PDOM metrics directly from StatHead data for every season.\n",
    "\n",
    "- Imports the pipeline from:\n",
    "  `src/pipelines/dom_merge_by_player.py`\n",
    "\n",
    "- Processes all seasons from **2000 through 2024**\n",
    "\n",
    "- Reads player/team data from:\n",
    "  `data/CFB_Data/StatHead/`\n",
    "\n",
    "- Produces a combined dataset containing per-player DOM metrics across all years\n",
    "\n",
    "After running, the cell prints:\n",
    "- Total rows generated  \n",
    "- List of years covered  \n",
    "- Conference distribution summary  \n",
    "- A small preview of the final dataset  \n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "b9bbed91",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Running DOM calculation for years 2000-2024...\n",
      "Processing 25 years: 2000 to 2024\n",
      "ðŸ“… Year 2000\n",
      "ðŸ“… Year 2001\n",
      "ðŸ“… Year 2002\n",
      "ðŸ“… Year 2003\n",
      "ðŸ“… Year 2004\n",
      "ðŸ“… Year 2005\n",
      "ðŸ“… Year 2006\n",
      "ðŸ“… Year 2007\n",
      "ðŸ“… Year 2008\n",
      "ðŸ“… Year 2009\n",
      "ðŸ“… Year 2010\n",
      "ðŸ“… Year 2011\n",
      "ðŸ“… Year 2012\n",
      "ðŸ“… Year 2013\n",
      "ðŸ“… Year 2014\n",
      "ðŸ“… Year 2015\n",
      "ðŸ“… Year 2016\n",
      "ðŸ“… Year 2017\n",
      "ðŸ“… Year 2018\n",
      "ðŸ“… Year 2019\n",
      "ðŸ“… Year 2020\n",
      "ðŸ“… Year 2021\n",
      "ðŸ“… Year 2022\n",
      "ðŸ“… Year 2023\n",
      "ðŸ“… Year 2024\n",
      "ðŸ“Š Loading PFF elusive rating data...\n",
      "âš ï¸ No PFF data found for 2000\n",
      "âš ï¸ No PFF data found for 2001\n",
      "âš ï¸ No PFF data found for 2002\n",
      "âš ï¸ No PFF data found for 2003\n",
      "âš ï¸ No PFF data found for 2004\n",
      "âš ï¸ No PFF data found for 2005\n",
      "âš ï¸ No PFF data found for 2006\n",
      "âš ï¸ No PFF data found for 2007\n",
      "âš ï¸ No PFF data found for 2008\n",
      "âš ï¸ No PFF data found for 2009\n",
      "âš ï¸ No PFF data found for 2010\n",
      "âš ï¸ No PFF data found for 2011\n",
      "âš ï¸ No PFF data found for 2012\n",
      "âš ï¸ No PFF data found for 2013\n",
      "ðŸ“Š Loaded 1379 PFF elusive ratings for 2014\n",
      "ðŸ“Š Loaded 1419 PFF elusive ratings for 2015\n",
      "ðŸ“Š Loaded 1503 PFF elusive ratings for 2016\n",
      "ðŸ“Š Loaded 1558 PFF elusive ratings for 2017\n",
      "ðŸ“Š Loaded 1616 PFF elusive ratings for 2018\n",
      "ðŸ“Š Loaded 1566 PFF elusive ratings for 2019\n",
      "ðŸ“Š Loaded 1334 PFF elusive ratings for 2020\n",
      "ðŸ“Š Loaded 1576 PFF elusive ratings for 2021\n",
      "ðŸ“Š Loaded 1562 PFF elusive ratings for 2022\n",
      "ðŸ“Š Loaded 1645 PFF elusive ratings for 2023\n",
      "ðŸ“Š Loaded 1680 PFF elusive ratings for 2024\n",
      "ðŸ”— Merged elusive ratings: 8333 matches found\n",
      "âœ… Wrote 2000 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2000.csv\n",
      "âœ… Wrote 2001 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2001.csv\n",
      "âœ… Wrote 2002 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2002.csv\n",
      "âœ… Wrote 2003 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2003.csv\n",
      "âœ… Wrote 2004 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2004.csv\n",
      "âœ… Wrote 2005 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2005.csv\n",
      "âœ… Wrote 2006 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2006.csv\n",
      "âœ… Wrote 2007 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2007.csv\n",
      "âœ… Wrote 2008 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2008.csv\n",
      "âœ… Wrote 2009 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2009.csv\n",
      "âœ… Wrote 2010 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2010.csv\n",
      "âœ… Wrote 2011 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2011.csv\n",
      "âœ… Wrote 2012 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2012.csv\n",
      "âœ… Wrote 2013 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2013.csv\n",
      "âœ… Wrote 2014 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2014.csv\n",
      "âœ… Wrote 2015 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2015.csv\n",
      "âœ… Wrote 2016 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2016.csv\n",
      "âœ… Wrote 2017 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2017.csv\n",
      "âœ… Wrote 2018 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2018.csv\n",
      "âœ… Wrote 2019 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2019.csv\n",
      "âœ… Wrote 2020 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2020.csv\n",
      "âœ… Wrote 2021 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2021.csv\n",
      "âœ… Wrote 2022 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2022.csv\n",
      "âœ… Wrote 2023 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2023.csv\n",
      "âœ… Wrote 2024 -> /Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/processed/dom_master_2024.csv\n",
      "\n",
      "Completed! Generated 31758 total rows.\n",
      "Years covered: [np.int64(2000), np.int64(2001), np.int64(2002), np.int64(2003), np.int64(2004), np.int64(2005), np.int64(2006), np.int64(2007), np.int64(2008), np.int64(2009), np.int64(2010), np.int64(2011), np.int64(2012), np.int64(2013), np.int64(2014), np.int64(2015), np.int64(2016), np.int64(2017), np.int64(2018), np.int64(2019), np.int64(2020), np.int64(2021), np.int64(2022), np.int64(2023), np.int64(2024)]\n",
      "\n",
      "Conference distribution across all years:\n",
      "conference\n",
      "SEC         3488\n",
      "ACC         3474\n",
      "BIG TEN     3363\n",
      "CUSA        3061\n",
      "MAC         2862\n",
      "BIG 12      2838\n",
      "MWC         2798\n",
      "SUN BELT    2729\n",
      "PAC 12      2560\n",
      "AMERICAN    2397\n",
      "Name: count, dtype: int64\n",
      "\n",
      "Sample of final data:\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>player</th>\n",
       "      <th>team</th>\n",
       "      <th>year</th>\n",
       "      <th>conference</th>\n",
       "      <th>DOM</th>\n",
       "      <th>RDOM</th>\n",
       "      <th>PDOM</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>A'Darius Purifoy*</td>\n",
       "      <td>Appalachian State</td>\n",
       "      <td>2017</td>\n",
       "      <td>SUN BELT</td>\n",
       "      <td>0.04</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>A'Darius Purifoy*</td>\n",
       "      <td>Appalachian State</td>\n",
       "      <td>2018</td>\n",
       "      <td>SUN BELT</td>\n",
       "      <td>0.50</td>\n",
       "      <td>0.00</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>A'Jon Vivens</td>\n",
       "      <td>Colorado State</td>\n",
       "      <td>2020</td>\n",
       "      <td>MWC</td>\n",
       "      <td>0.06</td>\n",
       "      <td>29.50</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>A'Jon Vivens</td>\n",
       "      <td>Colorado State</td>\n",
       "      <td>2021</td>\n",
       "      <td>MWC</td>\n",
       "      <td>1.21</td>\n",
       "      <td>8.22</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>A'Jon Vivens</td>\n",
       "      <td>Colorado State</td>\n",
       "      <td>2022</td>\n",
       "      <td>MWC</td>\n",
       "      <td>0.55</td>\n",
       "      <td>4.87</td>\n",
       "      <td>0.0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "              player               team  year conference   DOM   RDOM  PDOM\n",
       "0  A'Darius Purifoy*  Appalachian State  2017   SUN BELT  0.04   0.00   0.0\n",
       "1  A'Darius Purifoy*  Appalachian State  2018   SUN BELT  0.50   0.00   0.0\n",
       "2       A'Jon Vivens     Colorado State  2020        MWC  0.06  29.50   0.0\n",
       "3       A'Jon Vivens     Colorado State  2021        MWC  1.21   8.22   0.0\n",
       "4       A'Jon Vivens     Colorado State  2022        MWC  0.55   4.87   0.0"
      ]
     },
     "execution_count": 1,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import sys\n",
    "from pathlib import Path\n",
    "import importlib\n",
    "\n",
    "# Add the folder that CONTAINS \"src\" to sys.path\n",
    "ROOT = Path(\"/Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty\")\n",
    "if str(ROOT) not in sys.path:\n",
    "    sys.path.insert(0, str(ROOT))\n",
    "\n",
    "# Reload the module with conference fixes\n",
    "from src.pipelines import dom_merge_by_player\n",
    "importlib.reload(dom_merge_by_player)\n",
    "from src.pipelines.dom_merge_by_player import run_for_years\n",
    "\n",
    "BASE = \"/Users/chasesiegel/Desktop/Comp_Sci/Capstone/Dynasty/data/CFB_Data/StatHead\"\n",
    "\n",
    "# Run for all years from 2000 to 2024\n",
    "print(\"Running DOM calculation for years 2000-2024...\")\n",
    "years = list(range(2000, 2025))  # 2000 to 2024 inclusive\n",
    "print(f\"Processing {len(years)} years: {years[0]} to {years[-1]}\")\n",
    "\n",
    "out = run_for_years(years, base_dir=BASE, strict=False)\n",
    "print(f\"\\nCompleted! Generated {len(out)} total rows.\")\n",
    "print(f\"Years covered: {sorted(out['year'].unique())}\")\n",
    "print(\"\\nConference distribution across all years:\")\n",
    "print(out['conference'].value_counts().head(10))\n",
    "print(f\"\\nSample of final data:\")\n",
    "out[['player', 'team', 'year', 'conference', 'DOM', 'RDOM', 'PDOM']].head(5)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "ML_env",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.11.13"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
